flowchart TD
    A[Kvasir v2 Dataset<br/>8 classes, 8000 images] --> B[Preprocessing<br/>Resize 224x224, Normalize, Augment]
    B --> C[Split Data<br/>Train / Validation / Test]

    C --> D1[CNN Only]
    C --> D2[CNN + Capsules]
    C --> D3[CNN + CapsGNN]

    subgraph M1 [Model 1: CNN Only]
      D1 --> E1[ResNet18 Backbone]
      E1 --> F1[Global Average Pooling]
      F1 --> G1[Linear Classifier]
    end

    subgraph M2 [Model 2: CNN + Capsules]
      D2 --> E2[ResNet18 Backbone]
      E2 --> F2[Primary Capsules]
      F2 --> G2[Capsule Pooling]
      G2 --> H2[MLP Classifier]
    end

    subgraph M3 [Model 3: CNN + CapsGNN]
      D3 --> E3[ResNet18 Backbone]
      E3 --> F3[Primary Capsules]
      F3 --> G3[k-NN Graph Construction]
      G3 --> H3[GraphConv Layer 1]
      H3 --> I3[GraphConv Layer 2]
      I3 --> J3[Graph Pooling + MLP]
    end

    G1 --> K[Validation Metrics]
    H2 --> K
    J3 --> K

    K --> L[Best Checkpoint Selection]
    L --> N[Test Evaluation<br/>Accuracy, Loss, Report, Confusion Matrix]
    N --> O[Grad-CAM Explanation<br/>Best Model Heatmap Overlay]